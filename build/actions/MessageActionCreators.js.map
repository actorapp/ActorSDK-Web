{"version":3,"sources":["../../src/actions/MessageActionCreators.js"],"names":["MessageActionCreators","setMessages","setMessageShown","peer","message","onMessageShown","sendTextMessage","text","MESSAGE_SEND_TEXT","editTextMessage","rid","MESSAGES_EDIT_END","editMessage","catch","e","console","error","deleteMessage","MESSAGE_DELETE","sendFileMessage","file","MESSAGE_SEND_FILE","sendPhotoMessage","photo","MESSAGE_SEND_PHOTO","sendAnimationMessage","sendClipboardPhotoMessage","sendVoiceMessage","duration","voice","MESSAGE_SEND_VOICE","addLike","MESSAGE_LIKE_ADD","removeLike","MESSAGE_LIKE_REMOVE","messages","overlay","isLoaded","receiveDate","readDate","readByMeDate","MESSAGES_CHANGED","toggleSelected","id","MESSAGES_TOGGLE_SELECTED","startEditMessage","MESSAGES_EDIT_START","editLastMessage","uid","getUid","getState"],"mappings":"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","file":"MessageActionCreators.js","sourcesContent":["/*\n * Copyright (C) 2015 Actor LLC. <https://actor.im>\n */\n\nimport { throttle } from 'lodash';\nimport { dispatch } from '../dispatcher/ActorAppDispatcher';\nimport { ActionTypes } from '../constants/ActorAppConstants';\n\nimport ActorClient from '../utils/ActorClient';\nimport { prepareTextMessage, findLastEditableMessage } from '../utils/MessageUtils';\n\nimport MessageStore from '../stores/MessageStore';\n\nclass MessageActionCreators {\n  constructor() {\n    this.setMessages = throttle(this.setMessages, 10);\n  }\n\n  setMessageShown(peer, message) {\n    ActorClient.onMessageShown(peer, message);\n  }\n\n  sendTextMessage(peer, text) {\n    ActorClient.sendTextMessage(peer, prepareTextMessage(text));\n    dispatch(ActionTypes.MESSAGE_SEND_TEXT, { peer, text });\n  }\n\n  editTextMessage(peer, rid, text) {\n    dispatch(ActionTypes.MESSAGES_EDIT_END);\n    ActorClient.editMessage(peer, rid, text).catch((e) => {\n      console.error(e);\n    });\n  }\n\n  deleteMessage(peer, rid) {\n    ActorClient.deleteMessage(peer, rid);\n    dispatch(ActionTypes.MESSAGE_DELETE, { peer, rid });\n  }\n\n  sendFileMessage(peer, file) {\n    ActorClient.sendFileMessage(peer, file);\n    dispatch(ActionTypes.MESSAGE_SEND_FILE, { peer, file });\n  }\n\n  sendPhotoMessage(peer, photo) {\n    ActorClient.sendPhotoMessage(peer, photo);\n    dispatch(ActionTypes.MESSAGE_SEND_PHOTO, { peer, photo });\n  }\n\n  sendAnimationMessage(peer, file) {\n    ActorClient.sendAnimationMessage(peer, file);\n  }\n\n  // Deprecated\n  sendClipboardPhotoMessage(peer, photo) {\n    ActorClient.sendClipboardPhotoMessage(peer, photo);\n  }\n\n  sendVoiceMessage(peer, duration, voice) {\n    ActorClient.sendVoiceMessage(peer, duration, voice);\n    dispatch(ActionTypes.MESSAGE_SEND_VOICE, { peer, duration, voice });\n  }\n\n  addLike(peer, rid) {\n    ActorClient.addLike(peer, rid);\n    dispatch(ActionTypes.MESSAGE_LIKE_ADD, { peer, rid });\n  }\n\n  removeLike(peer, rid) {\n    ActorClient.removeLike(peer, rid);\n    dispatch(ActionTypes.MESSAGE_LIKE_REMOVE, { peer, rid });\n  }\n\n  setMessages(messages, overlay, isLoaded, receiveDate, readDate, readByMeDate) {\n    dispatch(ActionTypes.MESSAGES_CHANGED, {\n      messages,\n      overlay,\n      isLoaded,\n      receiveDate,\n      readDate,\n      readByMeDate\n    });\n  }\n\n  toggleSelected(id) {\n    dispatch(ActionTypes.MESSAGES_TOGGLE_SELECTED, { id });\n  }\n\n  startEditMessage(message) {\n    dispatch(ActionTypes.MESSAGES_EDIT_START, { message });\n  }\n\n  editLastMessage() {\n    const uid = ActorClient.getUid();\n    const { messages } = MessageStore.getState();\n    const message = findLastEditableMessage(messages, uid);\n\n    if (message) {\n      this.startEditMessage(message);\n    }\n  }\n}\n\nexport default new MessageActionCreators();\n"]}