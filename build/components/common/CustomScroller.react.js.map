{"version":3,"sources":["../../../src/components/common/CustomScroller.react.js"],"names":["raf","window","requestAnimationFrame","CustomScroller","props","state","top","height","draging","onScroll","bind","onResize","onMouseDown","onMouseMove","onMouseUp","onReference","shouldComponentUpdate","componentDidMount","updateState","onUpdate","addEventListener","componentWillUnmount","removeEventListener","componentDidUpdate","shouldUpdate","node","container","event","setState","dragging","lastPageY","pageY","document","onselectstart","body","classList","add","delta","scrollTop","scrollRatio","undefined","remove","getDimensions","scrollHeight","offsetHeight","getBoundingClientRect","getThumbStyle","Math","max","offsetAvailable","offsetPercent","offset","render","className","scrollbarClassName","children","callback","clientHeight","scrollTo","scrollToBottom","propTypes","string","isRequired","func","defaultProps"],"mappings":"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","file":"CustomScroller.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport { shouldComponentUpdate } from 'react-addons-pure-render-mixin';\nimport classNames from 'classnames';\nimport noop from 'lodash/noop';\n\nconst raf = window.requestAnimationFrame;\n\nclass CustomScroller extends Component {\n  static propTypes = {\n    className: PropTypes.string,\n    children: PropTypes.node.isRequired,\n    onUpdate: PropTypes.func.isRequired,\n    onScroll: PropTypes.func.isRequired,\n    onResize: PropTypes.func.isRequired\n  };\n\n  static defaultProps = {\n    onUpdate: noop,\n    onScroll: noop,\n    onResize: noop\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      top: 0,\n      height: 0,\n      draging: false\n    };\n\n    this.onScroll = this.onScroll.bind(this);\n    this.onResize = this.onResize.bind(this);\n    this.onMouseDown = this.onMouseDown.bind(this);\n    this.onMouseMove = this.onMouseMove.bind(this);\n    this.onMouseUp = this.onMouseUp.bind(this);\n    this.onReference = this.onReference.bind(this);\n    this.shouldComponentUpdate = shouldComponentUpdate.bind(this);\n  }\n\n  componentDidMount() {\n    this.updateState(true, this.props.onUpdate);\n    window.addEventListener('resize', this.onResize, false);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.onResize, false);\n  }\n\n  componentDidUpdate() {\n    if (this.shouldUpdate) {\n      this.updateState(true, this.props.onUpdate);\n    }\n  }\n\n  onReference(node) {\n    this.container = node;\n  }\n\n  onScroll() {\n    this.updateState(false, this.props.onScroll);\n  }\n\n  onResize() {\n    this.updateState(false, this.props.onResize);\n  }\n\n  onMouseDown(event) {\n    this.setState({ dragging: true });\n    this.lastPageY = event.pageY;\n\n    document.onselectstart = () => false;\n    document.body.classList.add('scroller__active');\n    document.addEventListener('mousemove', this.onMouseMove);\n    document.addEventListener('mouseup', this.onMouseUp);\n\n    return false;\n  }\n\n  onMouseMove(event) {\n    const delta = event.pageY - this.lastPageY;\n    this.lastPageY = event.pageY;\n\n    raf(() => this.container.scrollTop += delta / this.scrollRatio);\n  }\n\n  onMouseUp() {\n    this.setState({ dragging: false });\n\n    document.onselectstart = undefined;\n    document.body.classList.remove('scroller__active');\n    document.removeEventListener('mousemove', this.onMouseMove);\n    document.removeEventListener('mouseup', this.onMouseUp);\n  }\n\n  getDimensions() {\n    return {\n      scrollTop: this.container.scrollTop,\n      scrollHeight: this.container.scrollHeight,\n      offsetHeight: this.container.offsetHeight\n    };\n  }\n\n  getBoundingClientRect() {\n    return this.container.getBoundingClientRect();\n  }\n\n  getThumbStyle() {\n    const { scrollTop, scrollHeight, offsetHeight } = this.getDimensions();\n\n    if (scrollHeight === 0 || scrollHeight <= offsetHeight) {\n      return { top: 0, height: 0 };\n    }\n\n    const height = Math.max(30, (offsetHeight / scrollHeight) * offsetHeight);\n    const offsetAvailable = scrollHeight - offsetHeight;\n    const offsetPercent = offsetAvailable === 0 ? 0 : (scrollTop / offsetAvailable);\n    const offset = (offsetHeight - height) * offsetPercent;\n\n    return {\n      top: offset,\n      height: height\n    };\n  }\n\n  render() {\n    const { top, height, dragging } = this.state;\n\n    const className = classNames('scroller__container', this.props.className);\n    const scrollbarClassName = classNames('scroller__scrollbar', {\n      'scroller__scrollbar--active': dragging\n    });\n\n    return (\n      <div className=\"scroller__wrapper scroller__wrapper--custom\">\n        <div className={className} ref={this.onReference} onScroll={this.onScroll}>\n          {this.props.children}\n        </div>\n        <div className={scrollbarClassName}>\n          <div\n            className=\"scroller__thumb\"\n            style={{ top, height }}\n            onMouseDown={this.onMouseDown}\n          />\n        </div>\n      </div>\n    );\n  }\n\n  updateState(shouldUpdate, callback) {\n    this.shouldUpdate = shouldUpdate;\n\n    raf(() => {\n      const { scrollHeight, clientHeight } = this.container;\n      this.scrollRatio = clientHeight / scrollHeight;\n\n      this.setState(this.getThumbStyle(), callback);\n    });\n  }\n\n  scrollTo(offset) {\n    this.container.scrollTop = offset;\n  }\n\n  scrollToBottom() {\n    this.scrollTo(this.container.scrollHeight);\n  }\n}\n\nexport default CustomScroller;\n"]}