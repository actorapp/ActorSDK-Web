{"version":3,"sources":["../../../../src/components/dialog/compose/BotCommandsHint.react.js"],"names":[],"mappings":";;;;AAIA;;;;AACA;;;;AACA;;AACA;;;;AACA;;AAEA;;;;;;;;;;;;AAEA,IAAM,uBAAuB,EAA7B;AACA,IAAI,cAAc,CAAlB;;IAEM,e;;;AAOJ,2BAAY,KAAZ,EAAmB;AAAA;;AAAA,iDACjB,sBAAM,KAAN,CADiB;;AAGjB,UAAK,KAAL,GAAa;AACX,qBAAe;AADJ,KAAb;;AAIA,UAAK,QAAL,GAAgB,MAAK,QAAL,CAAc,IAAd,OAAhB;AACA,UAAK,SAAL,GAAiB,MAAK,SAAL,CAAe,IAAf,OAAjB;AACA,UAAK,eAAL,GAAuB,MAAK,eAAL,CAAqB,IAArB,OAAvB;AACA,UAAK,iBAAL,GAAyB,MAAK,iBAAL,CAAuB,IAAvB,OAAzB;AACA,UAAK,qBAAL,GAA6B,kDAAsB,IAAtB,OAA7B;AAXiB;AAYlB;;4BAED,iB,gCAAoB;AAClB,SAAK,SAAL,GAAiB,CACf,wBAAc,MAAd,CAAqB,QAArB,EAA+B,OAA/B,EAAwC,KAAK,eAA7C,CADe,EAEf,wBAAc,MAAd,CAAqB,QAArB,EAA+B,SAA/B,EAA0C,KAAK,iBAA/C,CAFe,CAAjB;AAID,G;;4BAED,oB,mCAAuB;AACrB,SAAK,SAAL,CAAe,OAAf,CAAuB,UAAC,QAAD;AAAA,aAAc,SAAS,MAAT,EAAd;AAAA,KAAvB;AACA,SAAK,SAAL,GAAiB,IAAjB;AACD,G;;4BAED,e,8BAAkB;AAChB,SAAK,KAAL,CAAW,OAAX;AACD,G;;4BAED,iB,8BAAkB,K,EAAO;AACvB,SAAK,SAAL,CAAe,KAAf;AACD,G;;4BAED,Q,qBAAS,G,EAAK;AACZ,QAAM,eAAe,2BAAY,KAAK,IAAL,CAAU,IAAtB,CAArB;AACA,iBAAa,SAAb,GAAyB,GAAzB;AACD,G;;4BAED,S,sBAAU,K,EAAO;AAAA,QACP,QADO,GACM,KAAK,KADX,CACP,QADO;AAAA,QAEP,aAFO,GAEW,KAAK,KAFhB,CAEP,aAFO;;AAGf,QAAM,eAAe,CAArB;AACA,QAAI,QAAQ,aAAZ;;AAEA,QAAI,UAAU,IAAd,EAAoB;AAClB,cAAQ,MAAM,OAAd;AACE,aAAK,4BAAS,KAAd;AACE,gBAAM,eAAN;AACA,gBAAM,cAAN;AACA,eAAK,KAAL,CAAW,QAAX,CAAoB,SAAS,aAAT,EAAwB,OAA5C;AACA;;AAEF,aAAK,4BAAS,QAAd;AACE,gBAAM,eAAN;AACA,gBAAM,cAAN;;AAEA,cAAI,QAAQ,CAAZ,EAAe;AACb,qBAAS,CAAT;AACD,WAFD,MAEO,IAAI,UAAU,CAAd,EAAiB;AACtB,oBAAQ,SAAS,MAAT,GAAkB,CAA1B;AACD;;AAED,cAAI,cAAc,KAAlB,EAAyB;AACvB,0BAAc,KAAd;AACD,WAFD,MAEO,IAAI,UAAU,SAAS,MAAT,GAAkB,CAAhC,EAAmC;AACxC,0BAAc,SAAS,MAAT,GAAkB,YAAhC;AACD;;AAED,eAAK,QAAL,CAAc,cAAc,oBAA5B;AACA,eAAK,QAAL,CAAc,EAAE,eAAe,KAAjB,EAAd;AACA;AACF,aAAK,4BAAS,UAAd;AACA,aAAK,4BAAS,GAAd;AACE,gBAAM,eAAN;AACA,gBAAM,cAAN;;AAEA,cAAI,QAAQ,SAAS,MAAT,GAAkB,CAA9B,EAAiC;AAC/B,qBAAS,CAAT;AACD,WAFD,MAEO,IAAI,UAAU,SAAS,MAAT,GAAkB,CAAhC,EAAmC;AACxC,oBAAQ,CAAR;AACD;;AAED,cAAI,QAAQ,CAAR,GAAY,cAAc,YAA9B,EAA4C;AAC1C,0BAAc,QAAQ,CAAR,GAAY,YAA1B;AACD,WAFD,MAEO,IAAI,UAAU,CAAd,EAAiB;AACtB,0BAAc,CAAd;AACD;;AAED,eAAK,QAAL,CAAc,cAAc,oBAA5B;AACA,eAAK,QAAL,CAAc,EAAE,eAAe,KAAjB,EAAd;AACA;AACF;AA9CF;AAgDD;;AAED,QAAI,MAAM,OAAN,KAAkB,4BAAS,GAA/B,EAAoC;AAClC,WAAK,KAAL,CAAW,OAAX;AACD;AACF,G;;4BAED,c,6BAAiB;AAAA;;AAAA,QACP,aADO,GACW,KAAK,KADhB,CACP,aADO;;;AAGf,WAAO,KAAK,KAAL,CAAW,QAAX,CAAoB,GAApB,CAAwB,gBAA2B,KAA3B,EAAqC;AAAA,UAAlC,OAAkC,QAAlC,OAAkC;AAAA,UAAzB,WAAyB,QAAzB,WAAyB;;AAClE,UAAM,YAAY,0BAAW,qBAAX,EAAkC;AAClD,uCAA+B,kBAAkB;AADC,OAAlC,CAAlB;;AAIA,aACE;AAAA;AAAA;AACE,eAAK,OADP;AAEE,qBAAW,SAFb;AAGE,mBAAS;AAAA,mBAAM,OAAK,KAAL,CAAW,QAAX,CAAoB,OAApB,CAAN;AAAA,WAHX;AAIE,uBAAa;AAAA,mBAAM,OAAK,QAAL,CAAc,EAAE,eAAe,KAAjB,EAAd,CAAN;AAAA;AAJf;AAME;AAAA;AAAA,YAAK,WAAU,OAAf;AACE;AAAA;AAAA,cAAM,WAAU,UAAhB;AAAA,kBAAgC;AAAhC,WADF;AAEE;AAAA;AAAA,cAAM,WAAU,MAAhB;AAAwB;AAAxB;AAFF;AANF,OADF;AAaD,KAlBM,CAAP;AAmBD,G;;4BAED,M,qBAAS;AACP,WACE;AAAA;AAAA,QAAK,WAAU,2BAAf;AACE;AAAA;AAAA,UAAK,WAAU,uBAAf;AACE;AAAA;AAAA,YAAQ,WAAU,sBAAlB;AACE;AAAA;AAAA,cAAK,WAAU,WAAf;AAA2B;AAAA;AAAA;AAAA;AAAA,aAA3B;AAAA;AAA+D;AAAA;AAAA;AAAA;AAAA,aAA/D;AAAiF;AAAA;AAAA;AAAA;AAAA,aAAjF;AAAA;AAAA,WADF;AAEE;AAAA;AAAA,cAAK,WAAU,WAAf;AAA2B;AAAA;AAAA;AAAA;AAAA,aAA3B;AAAA;AAAA,WAFF;AAGE;AAAA;AAAA,cAAK,WAAU,YAAf;AAA4B;AAAA;AAAA;AAAA;AAAA,aAA5B;AAAA;AAAA;AAHF,SADF;AAME;AAAA;AAAA,YAAI,WAAU,oBAAd,EAAmC,KAAI,MAAvC;AACG,eAAK,cAAL;AADH;AANF;AADF,KADF;AAcD,G;;;;;AAnJG,e,CACG,S,GAAY;AACjB,YAAU,iBAAU,KAAV,CAAgB,UADT;AAEjB,YAAU,iBAAU,IAAV,CAAe,UAFR;AAGjB,WAAS,iBAAU,IAAV,CAAe;AAHP,C;kBAqJN,e","file":"BotCommandsHint.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { PropTypes, Component } from 'react';\nimport EventListener from 'fbjs/lib/EventListener';\nimport { findDOMNode } from 'react-dom';\nimport classnames from 'classnames';\nimport { shouldComponentUpdate } from 'react-addons-pure-render-mixin';\n\nimport { KeyCodes } from '../../../constants/ActorAppConstants';\n\nconst DROPDOWN_ITEM_HEIGHT = 33;\nlet scrollIndex = 0;\n\nclass BotCommandsHint extends Component {\n  static propTypes = {\n    commands: PropTypes.array.isRequired,\n    onSelect: PropTypes.func.isRequired,\n    onClose: PropTypes.func.isRequired\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      selectedIndex: 0\n    };\n\n    this.scrollTo = this.scrollTo.bind(this);\n    this.onKeyDown = this.onKeyDown.bind(this);\n    this.onDocumentClick = this.onDocumentClick.bind(this);\n    this.onDocumentKeyDown = this.onDocumentKeyDown.bind(this);\n    this.shouldComponentUpdate = shouldComponentUpdate.bind(this);\n  }\n\n  componentDidMount() {\n    this.listeners = [\n      EventListener.listen(document, 'click', this.onDocumentClick),\n      EventListener.listen(document, 'keydown', this.onDocumentKeyDown)\n    ];\n  }\n\n  componentWillUnmount() {\n    this.listeners.forEach((listener) => listener.remove());\n    this.listeners = null;\n  }\n\n  onDocumentClick() {\n    this.props.onClose();\n  }\n\n  onDocumentKeyDown(event) {\n    this.onKeyDown(event);\n  }\n\n  scrollTo(top) {\n    const menuListNode = findDOMNode(this.refs.list);\n    menuListNode.scrollTop = top;\n  }\n\n  onKeyDown(event) {\n    const { commands } = this.props;\n    const { selectedIndex } = this.state;\n    const visibleItems = 3;\n    let index = selectedIndex;\n\n    if (index !== null) {\n      switch (event.keyCode) {\n        case KeyCodes.ENTER:\n          event.stopPropagation();\n          event.preventDefault();\n          this.props.onSelect(commands[selectedIndex].command);\n          break;\n\n        case KeyCodes.ARROW_UP:\n          event.stopPropagation();\n          event.preventDefault();\n\n          if (index > 0) {\n            index -= 1;\n          } else if (index === 0) {\n            index = commands.length - 1;\n          }\n\n          if (scrollIndex > index) {\n            scrollIndex = index;\n          } else if (index === commands.length - 1) {\n            scrollIndex = commands.length - visibleItems;\n          }\n\n          this.scrollTo(scrollIndex * DROPDOWN_ITEM_HEIGHT);\n          this.setState({ selectedIndex: index });\n          break;\n        case KeyCodes.ARROW_DOWN:\n        case KeyCodes.TAB:\n          event.stopPropagation();\n          event.preventDefault();\n\n          if (index < commands.length - 1) {\n            index += 1;\n          } else if (index === commands.length - 1) {\n            index = 0;\n          }\n\n          if (index + 1 > scrollIndex + visibleItems) {\n            scrollIndex = index + 1 - visibleItems;\n          } else if (index === 0) {\n            scrollIndex = 0;\n          }\n\n          this.scrollTo(scrollIndex * DROPDOWN_ITEM_HEIGHT);\n          this.setState({ selectedIndex: index });\n          break;\n        default:\n      }\n    }\n\n    if (event.keyCode === KeyCodes.ESC) {\n      this.props.onClose();\n    }\n  }\n\n  renderCommands() {\n    const { selectedIndex } = this.state;\n\n    return this.props.commands.map(({ command, description }, index) => {\n      const className = classnames('mention__list__item', {\n        'mention__list__item--active': selectedIndex === index\n      });\n\n      return (\n        <li\n          key={command}\n          className={className}\n          onClick={() => this.props.onSelect(command)}\n          onMouseOver={() => this.setState({ selectedIndex: index })}\n        >\n          <div className=\"title\">\n            <span className=\"nickname\">{`/${command}`}</span>\n            <span className=\"name\">{description}</span>\n          </div>\n        </li>\n      );\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"bot-commands bot-commands\">\n        <div className=\"bot-commands__wrapper\">\n          <header className=\"bot-commands__header\">\n            <div className=\"pull-left\"><strong>tab</strong>&nbsp; or &nbsp;<strong>↑</strong><strong>↓</strong>&nbsp; to navigate</div>\n            <div className=\"pull-left\"><strong>↵</strong>&nbsp; to select</div>\n            <div className=\"pull-right\"><strong>esc</strong>&nbsp; to close</div>\n          </header>\n          <ul className=\"bot-commands__list\" ref=\"list\">\n            {this.renderCommands()}\n          </ul>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default BotCommandsHint;\n"]}