{"version":3,"sources":["../../../../src/components/dialog/header/MoreDropdown.react.js"],"names":["MoreDropdown","props","context","console","debug","handleKeyDown","bind","handleDocumentClick","handleChatClear","handleChatDelete","handleChatLeave","handleRemoveFromContacts","handleAddToContacts","handleBlockUser","handleUnlockUser","handleEditGroup","handleAddPeople","componentDidMount","setListeners","componentWillUnmount","cleanListeners","listeners","listen","document","forEach","listener","remove","event","onClose","keyCode","ESC","stopPropagation","preventDefault","info","peer","message","key","USER","name","then","clearChat","deleteChat","leaveGroup","id","removeContact","addContact","blockUser","unblockUser","show","renderToggleContact","isContact","renderBlockUser","delegate","features","blocking","isBlocked","renderUserMenuItems","renderGroupMenuItems","renderPeerMenuItems","type","GROUP","renderMediaMenuItems","render","top","contextTypes","object","isRequired","propTypes","func"],"mappings":"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","file":"MoreDropdown.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport { FormattedMessage, FormattedHTMLMessage } from 'react-intl';\nimport EventListener from 'fbjs/lib/EventListener';\nimport { PeerTypes, KeyCodes } from '../../../constants/ActorAppConstants';\nimport confirm from '../../../utils/confirm';\n\nimport ContactActionCreators from '../../../actions/ContactActionCreators';\nimport DialogActionCreators from '../../../actions/DialogActionCreators';\nimport BlockedUsersActionCreators from '../../../actions/BlockedUsersActionCreators';\nimport EditGroupActionCreators from '../../../actions/EditGroupActionCreators';\nimport InviteUserActions from '../../../actions/InviteUserActions';\n\nclass MoreDropdown extends Component {\n  static contextTypes = {\n    delegate: PropTypes.object.isRequired\n  }\n\n  static propTypes = {\n    peer: PropTypes.object.isRequired,\n    info: PropTypes.object.isRequired,\n    onClose: PropTypes.func.isRequired\n  }\n\n  constructor(props, context) {\n    super(props, context);\n    console.debug(this.props);\n\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.handleDocumentClick = this.handleDocumentClick.bind(this);\n    this.handleChatClear = this.handleChatClear.bind(this);\n    this.handleChatDelete = this.handleChatDelete.bind(this);\n    this.handleChatLeave = this.handleChatLeave.bind(this);\n    this.handleRemoveFromContacts = this.handleRemoveFromContacts.bind(this);\n    this.handleAddToContacts = this.handleAddToContacts.bind(this);\n    this.handleBlockUser = this.handleBlockUser.bind(this);\n    this.handleUnlockUser = this.handleUnlockUser.bind(this);\n    this.handleEditGroup = this.handleEditGroup.bind(this);\n    this.handleAddPeople = this.handleAddPeople.bind(this);\n  }\n\n  componentDidMount() {\n    this.setListeners();\n  }\n\n  componentWillUnmount() {\n    this.cleanListeners();\n  }\n\n  setListeners() {\n    this.cleanListeners();\n    this.listeners = [\n      EventListener.listen(document, 'keydown', this.handleKeyDown),\n      EventListener.listen(document, 'click', this.handleDocumentClick)\n    ];\n  }\n\n  cleanListeners() {\n    if (this.listeners) {\n      this.listeners.forEach((listener) => listener.remove());\n      this.listeners = null;\n    }\n  }\n\n  handleDocumentClick(event) {\n    const { onClose } = this.props;\n    onClose(event);\n  }\n\n  handleKeyDown(event) {\n    const { onClose } = this.props;\n\n    if (event.keyCode === KeyCodes.ESC) {\n      event.stopPropagation();\n      event.preventDefault();\n      onClose(event)\n    }\n  }\n\n  handleChatClear() {\n    console.debug('handleChatClear');\n    const { info, peer } = this.props;\n\n    const message = peer.key === PeerTypes.USER\n      ? <FormattedHTMLMessage id=\"modal.confirm.user.clear\" values={{ name: info.name }} />\n      : <FormattedHTMLMessage id=\"modal.confirm.group.clear\" values={{ name: info.name }} />\n\n    confirm(message)\n      .then(\n        () => DialogActionCreators.clearChat(peer),\n        () => {}\n      );\n  }\n\n  handleChatDelete() {\n    console.debug('handleChatDelete');\n    const { info, peer } = this.props;\n\n    const message = peer.key === PeerTypes.USER\n      ? <FormattedHTMLMessage id=\"modal.confirm.user.delete\" values={{ name: info.name }} />\n      : <FormattedHTMLMessage id=\"modal.confirm.group.delete\" values={{ name: info.name }} />\n\n    confirm(message)\n      .then(\n        () => DialogActionCreators.deleteChat(peer),\n        () => {}\n      );\n  }\n\n  handleChatLeave() {\n    console.debug('handleChatLeave');\n    const { peer, info } = this.props;\n\n    confirm(<FormattedHTMLMessage id=\"modal.confirm.group.leave\" values={{ name: info.name }} />)\n      .then(\n        () => DialogActionCreators.leaveGroup(peer.id),\n        () => {}\n      );\n  }\n\n  handleRemoveFromContacts() {\n    const { peer, info } = this.props;\n\n    confirm(<FormattedHTMLMessage id=\"modal.confirm.user.removeContact\" values={{ name: info.name }}/>)\n      .then(\n        () => ContactActionCreators.removeContact(peer.id),\n        () => {}\n      );\n  }\n\n  handleAddToContacts() {\n    const { peer } = this.props;\n    ContactActionCreators.addContact(peer.id);\n  }\n\n  handleBlockUser() {\n    const { peer, info } = this.props;\n\n    confirm(<FormattedHTMLMessage id=\"modal.confirm.user.block\" values={{ name: info.name }} />)\n      .then(\n        () => BlockedUsersActionCreators.blockUser(peer.id),\n        () => {}\n      );\n  }\n\n  handleUnlockUser() {\n    const { peer } = this.props;\n    BlockedUsersActionCreators.unblockUser(peer.id);\n  }\n\n  handleEditGroup() {\n    const { peer } = this.props;\n    EditGroupActionCreators.show(peer.id);\n  }\n\n  handleAddPeople() {\n    const { info } = this.props;\n    InviteUserActions.show(info)\n  }\n\n  renderToggleContact() {\n    const { info: { isContact } } = this.props;\n\n    if (isContact) {\n      return (\n        <li className=\"dropdown__menu__item\" onClick={this.handleRemoveFromContacts}>\n          <FormattedMessage id=\"removeFromContacts\"/>\n        </li>\n      );\n    }\n\n    return (\n      <li className=\"dropdown__menu__item\" onClick={this.handleAddToContacts}>\n        <FormattedMessage id=\"addToContacts\"/>\n      </li>\n    );\n  }\n\n  renderBlockUser() {\n    if (!this.context.delegate.features.blocking) {\n      return null;\n    }\n\n    const { info: { isBlocked } } = this.props;\n\n    if (isBlocked) {\n      return (\n        <li className=\"dropdown__menu__item\" onClick={this.handleUnlockUser}>\n          <FormattedMessage id=\"compose.unblock\" />\n        </li>\n      );\n    }\n\n    return (\n      <li className=\"dropdown__menu__item\" onClick={this.handleBlockUser}>\n        <FormattedMessage id=\"blockUser\"/>\n      </li>\n    );\n  }\n\n  renderUserMenuItems() {\n    return (\n      <div>\n        {this.renderToggleContact()}\n        {this.renderBlockUser()}\n        <li className=\"dropdown__menu__item\" onClick={this.handleChatClear}>\n          <FormattedMessage id=\"clearConversation\"/>\n        </li>\n        <li className=\"dropdown__menu__item\" onClick={this.handleChatDelete}>\n          <FormattedMessage id=\"deleteConversation\"/>\n        </li>\n      </div>\n    );\n  }\n\n  renderGroupMenuItems() {\n    return (\n      <div>\n        <li className=\"dropdown__menu__item\" onClick={this.handleEditGroup}>\n          <i className=\"material-icons\">mode_edit</i>\n          <FormattedMessage id=\"editGroup\"/>\n        </li>\n        {/*<li className=\"dropdown__menu__item\" onClick={this.handleAddPeople}>\n          <i className=\"material-icons\">group_add</i>\n          <FormattedMessage id=\"addPeople\"/>\n        </li>*/}\n        <li className=\"dropdown__menu__item\" onClick={this.handleChatLeave}>\n          <FormattedMessage id=\"leaveGroup\"/>\n        </li>\n        <li className=\"dropdown__menu__item\" onClick={this.handleChatClear}>\n          <FormattedMessage id=\"clearGroup\"/>\n        </li>\n        <li className=\"dropdown__menu__item\" onClick={this.handleChatDelete}>\n          <FormattedMessage id=\"deleteGroup\"/>\n        </li>\n      </div>\n    );\n  }\n\n  renderPeerMenuItems() {\n    const { peer } = this.props;\n\n    switch (peer.type) {\n      case PeerTypes.USER:\n        return this.renderUserMenuItems()\n      case PeerTypes.GROUP:\n        return this.renderGroupMenuItems()\n      default:\n        return null;\n    }\n  }\n\n  renderMediaMenuItems() {\n    return (\n      <div>\n        <li className=\"dropdown__menu__item\">\n          <i className=\"material-icons\">photo</i>\n          Find Photos\n        </li>\n        <li className=\"dropdown__menu__item\">\n          <i className=\"material-icons\">link</i>\n          Find Links\n        </li>\n        <li className=\"dropdown__menu__item\">\n          <i className=\"material-icons\">insert_drive_file</i>\n          Find Documents\n        </li>\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <ul className=\"dropdown__menu dropdown__menu--right\" style={{ top: 42 }}>\n        {/*{this.renderMediaMenuItems()}*/}\n        {this.renderPeerMenuItems()}\n      </ul>\n    );\n  }\n}\n\nexport default MoreDropdown;\n"]}